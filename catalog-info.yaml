---
apiVersion: backstage.io/v1alpha1
kind: System
metadata:
  name: fluxo-caixa
  title: Sistema de Fluxo de Caixa
  description: Sistema de controle de fluxo de caixa com arquitetura de microsserviços
  tags:
    - dotnet
    - microservices
    - ddd
    - csharp
    - financial
  links:
    - url: https://github.com/raftriani/FluxoCaixa
      title: Repositório GitHub
      icon: github
  annotations:
    github.com/project-slug: raftriani/FluxoCaixa
spec:
  owner: user:default/rafael.triani
  domain: financial

---
apiVersion: backstage.io/v1alpha1
kind: Component
metadata:
  name: fluxocaixa-lancamentos-api
  title: API de Lançamentos
  description: Microsserviço responsável por gerenciar lançamentos de crédito e débito
  tags:
    - api
    - dotnet-core
    - microservice
    - sql-server
  annotations:
    github.com/project-slug: raftriani/FluxoCaixa
    backstage.io/techdocs-ref: dir:.
spec:
  type: service
  lifecycle: production
  owner: user:default/rafael.triani
  system: fluxo-caixa
  providesApis:
    - lancamentos-api
  dependsOn:
    - resource:sqlserver-lancamentos
    - resource:rabbitmq

---
apiVersion: backstage.io/v1alpha1
kind: API
metadata:
  name: lancamentos-api
  title: API de Lançamentos
  description: API REST para lançamentos de crédito e débito no fluxo de caixa
  tags:
    - rest
    - dotnet
spec:
  type: openapi
  lifecycle: production
  owner: user:default/rafael.triani
  system: fluxo-caixa
  definition: |
    openapi: 3.0.0
    info:
      title: Lançamentos API
      version: 1.0.0
      description: API para gerenciamento de lançamentos financeiros
    servers:
      - url: http://localhost:5001/cashier/api
        description: Servidor local
    paths:
      /account/add-entry:
        post:
          summary: Adicionar lançamento de crédito ou débito
          operationId: addEntry
          tags:
            - Account
          requestBody:
            required: true
            content:
              application/json:
                schema:
                  type: object
                  properties:
                    Type:
                      type: integer
                      description: Tipo do lançamento (1 = Crédito, 2 = Débito)
                    Value:
                      type: number
                      description: Valor do lançamento
                    Description:
                      type: string
                      description: Descrição do lançamento
          responses:
            '200':
              description: Lançamento criado com sucesso
      /account/show-info:
        get:
          summary: Obter informações da conta
          operationId: getAccountInfo
          tags:
            - Account
          responses:
            '200':
              description: Informações da conta
              content:
                application/json:
                  schema:
                    type: object
                    properties:
                      value:
                        type: number
                      lastUpdate:
                        type: string
                        format: date-time

---
apiVersion: backstage.io/v1alpha1
kind: Component
metadata:
  name: fluxocaixa-consolidacao-api
  title: API de Consolidação
  description: Microsserviço responsável por consolidar dados financeiros
  tags:
    - api
    - dotnet-core
    - microservice
    - mongodb
  annotations:
    github.com/project-slug: raftriani/FluxoCaixa
spec:
  type: service
  lifecycle: production
  owner: user:default/rafael.triani
  system: fluxo-caixa
  providesApis:
    - consolidacao-api
  dependsOn:
    - resource:mongodb-consolidacao
    - resource:rabbitmq

---
apiVersion: backstage.io/v1alpha1
kind: API
metadata:
  name: consolidacao-api
  title: API de Consolidação
  description: API para consolidação de dados financeiros
  tags:
    - rest
    - dotnet
spec:
  type: openapi
  lifecycle: production
  owner: user:default/rafael.triani
  system: fluxo-caixa
  definition: |
    openapi: 3.0.0
    info:
      title: Consolidação API
      version: 1.0.0
    servers:
      - url: http://localhost:5002/consolidation/api

---
apiVersion: backstage.io/v1alpha1
kind: Component
metadata:
  name: fluxocaixa-relatorio-api
  title: API de Relatórios
  description: Microsserviço responsável por gerar relatórios consolidados
  tags:
    - api
    - dotnet-core
    - microservice
    - mongodb
  annotations:
    github.com/project-slug: raftriani/FluxoCaixa
spec:
  type: service
  lifecycle: production
  owner: user:default/rafael.triani
  system: fluxo-caixa
  providesApis:
    - relatorio-api
  dependsOn:
    - resource:mongodb-relatorio

---
apiVersion: backstage.io/v1alpha1
kind: API
metadata:
  name: relatorio-api
  title: API de Relatórios
  description: API REST para geração de relatórios diários consolidados
  tags:
    - rest
    - dotnet
spec:
  type: openapi
  lifecycle: production
  owner: user:default/rafael.triani
  system: fluxo-caixa
  definition: |
    openapi: 3.0.0
    info:
      title: Relatórios API
      version: 1.0.0
      description: API para geração de relatórios financeiros
    servers:
      - url: http://localhost:5003/reports/api
    paths:
      /report/show-daily-report:
        get:
          summary: Obter relatório diário consolidado
          operationId: getDailyReport
          tags:
            - Report
          parameters:
            - name: month
              in: query
              required: true
              schema:
                type: integer
            - name: year
              in: query
              required: true
              schema:
                type: integer
            - name: day
              in: query
              required: true
              schema:
                type: integer
          responses:
            '200':
              description: Relatório diário
              content:
                application/json:
                  schema:
                    type: array
                    items:
                      type: object
                      properties:
                        userId:
                          type: string
                        userName:
                          type: string
                        entryType:
                          type: integer
                        entryValue:
                          type: number
                        accountValueAfterEntry:
                          type: number
                        entryDescription:
                          type: string
                        entryDate:
                          type: string
                          format: date-time

---
apiVersion: backstage.io/v1alpha1
kind: Resource
metadata:
  name: sqlserver-lancamentos
  title: SQL Server - Lançamentos
  description: Banco de dados SQL Server para persistência de lançamentos
  tags:
    - database
    - sqlserver
spec:
  type: database
  lifecycle: production
  owner: user:default/rafael.triani
  system: fluxo-caixa

---
apiVersion: backstage.io/v1alpha1
kind: Resource
metadata:
  name: mongodb-consolidacao
  title: MongoDB - Consolidação
  description: Banco de dados MongoDB para dados consolidados
  tags:
    - database
    - mongodb
    - nosql
spec:
  type: database
  lifecycle: production
  owner: user:default/rafael.triani
  system: fluxo-caixa

---
apiVersion: backstage.io/v1alpha1
kind: Resource
metadata:
  name: mongodb-relatorio
  title: MongoDB - Relatórios
  description: Banco de dados MongoDB para relatórios
  tags:
    - database
    - mongodb
    - nosql
spec:
  type: database
  lifecycle: production
  owner: user:default/rafael.triani
  system: fluxo-caixa

---
apiVersion: backstage.io/v1alpha1
kind: Resource
metadata:
  name: rabbitmq
  title: RabbitMQ
  description: Message broker para comunicação entre microsserviços
  tags:
    - messaging
    - rabbitmq
    - event-driven
spec:
  type: message-broker
  lifecycle: production
  owner: user:default/rafael.triani
  system: fluxo-caixa

---
apiVersion: backstage.io/v1alpha1
kind: API
metadata:
  name: contrato-aquisicao-software
  title: Contrato de Aquisição de Software
  description: Contrato público para aquisição de licenças de software
  tags:
    - ocds
    - contrato
    - compras
    - procurement
  annotations:
    github.com/project-slug: raftriani/FluxoCaixa
spec:
  type: ocds
  lifecycle: production
  owner: user:default/rafael.triani
  system: fluxo-caixa
  ocds:
    schemaType: release
    schemaVersion: 1.1.5
    data:
      ocid: ocds-fluxocaixa-2024-001
      date: 2024-12-15T10:30:00Z
      language: pt
      buyer:
        name: Secretaria de Tecnologia da Informação
        id: BR-CNPJ-12.345.678/0001-90
        address:
          streetAddress: Av. Paulista, 1000
          locality: São Paulo
          region: SP
          postalCode: 01310-100
          countryName: Brasil
        contactPoint:
          name: João Silva
          email: joao.silva@governo.br
          telephone: +55 11 9999-8888
      tender:
        id: TENDER-2024-001
        title: Aquisição de Sistema de Gestão Financeira
        description: Contratação de solução de software para gestão de fluxo de caixa e relatórios financeiros consolidados
        status: active
        value:
          amount: 250000.00
          currency: BRL
        procurementMethod: open
        procurementMethodDetails: Pregão Eletrônico
        tenderPeriod:
          startDate: 2024-12-15T10:00:00Z
          endDate: 2025-01-15T18:00:00Z
        items:
          - id: "1"
            description: Licenças de software de gestão financeira - 100 usuários simultâneos
            classification:
              scheme: CPV
              id: "48000000"
              description: Pacotes de software e sistemas de informação
            quantity: 100
            unit:
              name: Licença
              value:
                amount: 2000.00
                currency: BRL
          - id: "2"
            description: Serviços de implementação, customização e treinamento
            classification:
              scheme: CPV
              id: "72000000"
              description: Serviços de TI consultoria e desenvolvimento
            quantity: 1
            unit:
              name: Serviço
              value:
                amount: 50000.00
                currency: BRL
      awards:
        - id: award-2024-001
          status: pending
          title: Proposta Vencedora
          description: Aguardando homologação do resultado
          date: 2025-01-30T18:00:00Z
          value:
            amount: 245000.00
            currency: BRL
          suppliers:
            - name: TechSoft Soluções em Software Ltda
              id: BR-CNPJ-98.765.432/0001-10
              address:
                streetAddress: Rua dos Desenvolvedores, 500
                locality: São Paulo
                region: SP
                postalCode: 04567-890
                countryName: Brasil
      contracts:
        - id: contract-2024-001
          status: pending
          title: Contrato de Fornecimento de Software
          description: Contrato para fornecimento de licenças e serviços de implementação
          period:
            startDate: 2025-02-01T00:00:00Z
            endDate: 2026-02-01T00:00:00Z
          value:
            amount: 245000.00
            currency: BRL
